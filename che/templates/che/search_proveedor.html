{%extends 'base/base.html' %}
{%load static%}
{%block page_content %}
<font color="blue" face="TimensRouw">
<h2 align="center">Buscador de Proveedores </h2>
</font>
<br>
<form class="form-inline" action="." method="GET" autocomplete="off">
<span>Fecha Inicial</span>
<input class="form-control mr-sm-2" type="date"  name="date_min" id="date_min" size=50% >

<span>Fecha Final</span>
	<input class="form-control mr-sm-2" type="date"  name="date_max" id="date_max" size=50% >

	<div class="striped" cellspacing="0" width="100%">
		<label for="category">Proveedor</label>
		<select id="category" class="form-control" name="category">
			<option selected>Buscar...</option>
			{% for cat in proveedor %}
			<option value="{{ cat }}">{{ cat }}</option>
			{% endfor %}
		</select>
		<button class="btn btn-outline-success my-2 my-sm-0" type="submit">Buscar</button>
	</div>
	<br>
	<div class="form-group col-md-4">
		<button class="btn btn-warning" type="submit" id="btnPrint">Imprimir</button>
	</div>
</form>
<br>

  <br>
					{% if queryset %}

			<div class="">

				<br>
			  		<table class="table table-striped table-bordered table-sm" cellspacing="0" width="100%">
			      <thead>
			      <tr>
			        <th>No. Cheque</th>
							<th>Cantidad</th>
							<th>Fch. P.</th>
							<th>Pagar a:</th>
							<th>Cuenta</th>
							<th></th>
			      </tr>
			    	</thead>
						<tbody>
							{% for cheque in queryset %}
			      <tr>
							<td>{{cheque.no_cheque}}</td>
							<td>{{cheque.cantidad}}</td>
							<td>{{cheque.fecha_pagar|date:"l, d/m/Y"}}</td>
							<td>{{cheque.proveedor}}</td>
							<td>{{cheque.cuenta}}</td>
									{% for cat in cheque.proveedor.all %}
									<td>{{ cat }}</td>
							  	{% endfor %}
							<td><a class="btn btn-primary" href="{% url "che:detail_cheque" cheque.id%}">D</a> </td>
			      </tr>
							{% endfor %}
				</tbody>
			  </table>
				</div>
				{%endif%}

{%endblock%}
{% block js_page %}
<script>
 // Call the dataTables jQuery plugin
$(document).ready(function() {
	$('.table').DataTable({
		"scrollX": true,
		"scrollY": 400,
		"language": {
			"sProcessing": "Procesando...",
			"sLengthMenu": "Mostrar _MENU_ registros",
			"sZeroRecords": "No se encontraron resultados",
			"sEmptyTable": "Ning√∫n dato disponible en esta tabla",
			"sInfo": "Mostrando registros del _START_ al _END_ de un total de _TOTAL_ registros",
			"sInfoEmpty": "Mostrando registros del 0 al 0 de un total de 0 registros",
			"sInfoFiltered": "(filtrado de un total de _MAX_ registros)",
			"sInfoPostFix": "",
			"sSearch": "Buscar:",
			"sUrl": "",
			"sInfoThousands": ",",
			"sLoadingRecords": "Cargando...",
			  "oPaginate": {
			    "sFirst": "<span class='fa fa-angle-double-left'></span>",
			     "sLast": "<span class='fa fa-angle-double-right'></span>",
			     "sNext": "<span class='fa fa-angle-right'></span>",
			     "sPrevious": "<span class='fa fa-angle-left'></span>"
			   },
			   "oAria": {
			     "sSortAscending": ": Activar para ordenar la columna de manera ascendente",
			     "sSortDescending": ": Activar para ordenar la columna de manera descendente"
			   }
		}
	});
	$("#btnPrint").click(function(e){
		e.preventDefault();
		var date_min,date_max;
		date_min = $("#date_min").val();
		date_max = $("#date_max").val();
		if(date_min=="" || date_min==null){
			date_min="2019-06-01";
		}
		if(date_max=="" || date_max==null){
			var d = new Date();
			var date_max = d.getFullYear() + "-" + (d.getMonth()+1) + "-" + d.getDate();
		}

		var url = "che/imprimir-todas/" + date_min + "/" + date_max;

		window.open(url,'cheques');
	});
});
</script>
{% endblock %}
